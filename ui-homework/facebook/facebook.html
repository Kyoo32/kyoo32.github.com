<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="facebook.css">
	<title>My Facebook</title>
</head>
<body>
	<!-- header -->
	<header id="global-header"></header>
	<!-- /header -->
	<!-- main -->
	<main>
		<!-- left-sidebar -->
		<section id="left-sidebar">
			<div id="profile">
				<div class="icon"><img src="taegon.png" style="width: 18px; height:18px;"> </div>김태곤
			</div>
			<div id="profile-edit">
				<div class="icon" ><img src="profile-edit.png"></div><span class="word">프로필 편집</span></div>
			<div id="bookmarks">즐겨찾기</div>
			<div class="leftside-row">
				<div class="icon"><img src="newsfeed.png"></div>
				<span class="word">뉴스피드</span>	
				<div class="leftside-row-more-info"><img src="bottom-point.png"></div>
			</div>
			<div id="group">그룹</div>
			<div class="leftside-row">
				<div class="icon"><img src="next.png"></div>
				<span class="word">NEXT 사제지간</span>	
				<div class="leftside-row-more-info">3</div>
			</div>
		</section>
		<!-- /left-sidebar -->
		<!-- content section -->
		<section id="content-wrapper">
			<div class="content-box">
				<div class="content-name"> <img class="profile-image" src="taegon.png"> JB </div>
			 	<div class="content-content">안녕하세요</div>
			 	<div class="button-count">
			 		좋아요 <span class="like-count">2</span>개
			 		댓글 <span class="comment-count">3</span>개
			 		공유 <span class="share-count">4</span>개
			 	</div>
			 	<div class="content-button">
			 		<img src="thumbs-up.svg"><span class="like-button">좋아요 </span>
			 		<img src="comment.svg"><span class="comment-button">댓글달기 </span>
			 		<img src="mail-forward.svg"><span class="share-button">공유하기 </span>
			 	</div>
			</div>
			<div class="content-box">
				<div class="content-name">  JB </div>
			 	<div class="content-content">반가워요</div> 
			 	<div class="button-count">
			 		좋아요 <span class="like-count">0</span>개
			 		댓글 <span class="comment-count">0</span>개
			 		공유 <span class="share-count">0</span>개
			 	</div>
			 	<div class="content-button">
			 		<img src="thumbs-up.svg"><span class="like-button">좋아요 </span>
			 		<img src="comment.svg"><span class="comment-button">댓글달기 </span>
			 		<img src="mail-forward.svg"><span class="share-button">공유하기 </span>
			 	</div>
			</div>
		</section>
		<!-- /content section -->
		<!-- right-sidebar -->
		<section id="right-sidebar">
			<div id="right-sidebar-box"></div>
		</section>
		<!-- /right-sidebar -->
	</main>
	<!-- /main -->
	<script>
		//scroll infinitly
		window.onscroll= function(){
			if(document.body.scrollHeight - document.body.scrollTop < 1000) {

					var newDiv = document.createElement('div');
					newDiv.classList.add('content-box');
					var newName = document.createElement('div');
					newName.classList.add('content-name');
					var newContent = document.createElement('div');
					newContent.classList.add('content-content');
					
					//갯수 
					var newCount = document.createElement('div');
					newCount.classList.add('button-count');

					var newLike = document.createElement('span');
					newLike.classList.add("like-count");
					newLike.textContent = 2;
					newCount.appendChild(document.createTextNode("좋아요 "));
					newCount.appendChild(newLike);
					newCount.appendChild(document.createTextNode('개 '));

					var newComment = document.createElement('span');
					newComment.classList.add("comment-count");
					newComment.textContent = 3;
					newCount.appendChild(document.createTextNode("댓글 "));
					newCount.appendChild(newComment);
					newCount.appendChild(document.createTextNode('개 '));

					var newShare = document.createElement('span');
					newShare.classList.add("share-count");
					newShare.textContent = 4;
					newCount.appendChild(document.createTextNode("공유 "));
					newCount.appendChild(newShare);
					newCount.appendChild(document.createTextNode('개 '));
					
					//버튼
					var newButton = document.createElement('div');
					newButton.classList.add('content-button');

					var likeImg = document.createElement('img');
					likeImg.src="thumbs-up.svg";
					var newLikeB = document.createElement('span');
					newLikeB.classList.add("like-button");
					newLikeB.textContent = '좋아요 ';
					newButton.appendChild(likeImg);
					newButton.appendChild(newLikeB);

					var commentImg = document.createElement('img');
					commentImg.src="comment.svg";
					var newCommentB = document.createElement('span');
					newCommentB.classList.add("comment-button");
					newCommentB.textContent = '댓글달기 ';
					newButton.appendChild(commentImg);
					newButton.appendChild(newCommentB);

					var shareImg = document.createElement('img');
					shareImg.src="mail-forward.svg";
					var newShareB = document.createElement('span');
					newShareB.classList.add("share-button");
					newShareB.textContent = '공유하기 ';
					newButton.appendChild(shareImg);
					newButton.appendChild(newShareB);

					newDiv.appendChild(newName);
					newDiv.appendChild(newContent);
					newDiv.appendChild(newCount);
					newDiv.appendChild(newButton);
					

					var wrapper = document.getElementById('content-wrapper');
					wrapper.appendChild(newDiv);
			}
		console.log(document.body.scrollHeight - document.body.scrollTop);	
		}


		//click button and delegate event to count text and icon style
		document.addEventListener("click", function(evt){
			var target = evt.target;
				tagName = target.tagName;

			if(tagName==="SPAN"){
				if(target.style.color === ""){
					target.style.color = "blue";

				}
				else if(target.style.color === "blue"){
					target.style.color = "";
				}
			}

			if(target.className === "like-button"){
				var count = target.parentNode.parentNode.querySelector(".like-count");
				var savedCount = parseInt(count.innerHTML);
				var targetImg = target.parentNode.parentNode.querySelector(".content-button img:first-child");	

				console.log(targetImg);
				if(target.style.color ===""){
					savedCount -= 1;
					targetImg.style.fill = "";
				}
				else if(target.style.color ==="blue"){
					savedCount +=1;
					targetImg.style.fill = "blue";
				}	
				count.innerHTML = savedCount.toString();	

			} else if(target.className === "comment-button"){
				var count = target.parentNode.parentNode.querySelector(".comment-count");
				var savedCount = parseInt(count.innerHTML);
				if(target.style.color === ""){
					savedCount -= 1;
				}
				else if(target.style.color ==="blue"){
					savedCount += 1;
				}	
				count.innerHTML = savedCount.toString();
			} else if(target.className === "share-button"){
				var count = target.parentNode.parentNode.querySelector(".share-count");
				var savedCount = parseInt(count.innerHTML);
				if(target.style.color ===""){
					savedCount -= 1;
				}
				else if(target.style.color ==="blue"){
					savedCount +=1;
				}	
				count.innerHTML = savedCount.toString();
			}

		});

		//load five content-box from json
		var xmlhttp = new XMLHttpRequest();
		var url = "five-content.txt";
		
		xmlhttp.onreadystatechange = function() {
		    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
		        var myArr = JSON.parse(xmlhttp.responseText);
		        myFunction(myArr);
		    }
		}
		xmlhttp.open("GET", url, true);
		xmlhttp.send();

		function myFunction(arr) {
		    var out = "";
		    var i;
		    for(i = 0; i < arr.length; i++) {
		        out = arr[i].name.first + arr[i].name.last;
				document.querySelector("content-name").innerHTML = out;
				console.log(out);
				console.log(document.querySelector("content-name"));
				out = arr[i].content;
				document.querySelector("content-content").innerHTML = out;
				console.log(out);
				console.log(document.querySelector("content-content"));
				out = arr[i].likeCount;
				document.querySelector("like-count").innerHTML = out;
				console.log(out);
				//console.log(document.querySelector("content-name"));
				out = arr[i].commentCount;
				document.querySelector("comment-count").innerHTML = out;
				console.log(out);
				//console.log(document.querySelector("content-name"));
				out = arr[i].shareCount;
				document.querySelector("share-count").innerHTML = out;
				console.log(out);
				//console.log(document.querySelector("content-name"));
				if(arr[i].doesLike === true);
		    }
		}
		
	</script>
</body>
</html>
